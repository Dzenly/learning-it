https://www.youtube.com/watch?v=tQ8F7d2VACU&t=14615s

* Не должно быть состояния.

* Минимизировать кол-во слоев.

* RUN apt-get update
сама по себе не приведет к пересборке, когда что-то изменится.

COPY package.json /usr/src/app
Хранит хэш файла, если хэш не менялся - возьмет слой из кэша.

Но RUN apt-get update && apt-get install -y - приведет.
Якобы потому, что docker RUN как-то узнает, что mc в результате команды поставится новый,
и это изменит хэш файлов системы.

*Команды обновления пакетов и установки пакетов - надо класть в одну строчку.*

Сортировка по алфавиту в RUN.

Есть --no-cache=true.

Стандартная практика - иметь в своих переменных окружения версии.

docker run --it container
env

ADD без нужды не использовать.
Умеет вытаскивать из веба.

Если найдена уязвимость в софте из базовых слоев.
То надо где-то достать этот базовый слой без уязвимости,
и обновить все свои контейнеры.
Либо убедиться, что весь этот софт закрыт от доступа снаружи.
И пристальней следить за всякими инжекциями.

Стандартный node и node-alpine отличаются по размерам в 10 раз.

Чтобы убедиться что нет вредоносов - можно посмотреть Dockerfile образа.

Ещё имеет смысл смотреть кол-во звездочек, и пометку "official".

docker save vs docker export

volumes

volume containers - специальные контейнеры, которые тупо хранят состояния.
Без нужды не нужно юзать на хайлоаде. Ибо оверхеды, и сложно настраивать
производительность, получать поддержку от производителей дисков.

Не нужно сохранять в конечном контейнере сами тулзы и их зависимости,
которые использовались для билда чего-то в контейнере.
Допустим webpack, sencha cmd и т.д.

Докер в разработке - есть боли.
















